---
title: "assignment_2"
format: html
editor: visual
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo       = TRUE, 
                      fig.height = 3, 
                      fig.width  = 6,
                      fig.align  = "center")
ggplot2::theme_set(ggplot2::theme_bw())
```

```{r}
#| message: false
library(tidyverse)

library(lubridate)
```

# Question 1:

Write a function `pos_na()` that takes two vectors of equal length and returns the positions where **both** vectors contain `NA`.\
If the vectors do **not** have the same length, the function should return the message:

> `"The vectors are not the same length."`

Use the following pairs of vectors to test your function:

1.  `c(1, NA, 2)` and `c(NA, NA)`
2.  `c(NA, NA, 2)` and `c(NA, NA, 2)`
3.  `c(NA, 5, NA)` and `c(NA, NA, NA)`
4.  `c(NA, NA, NA, 2, NA, 4, NA)` and `c(NA, NA, 2, 4, 4, NA, NA)`
5.  `c(1, NA, NA, 2, NA, 4, NA)` and `c(NA, -5, 2, 4, 4, NA, 11)`

Here’s a polished, professional way to label those two parts of the assignment. It reads cleanly and sets expectations without adding extra wording.

```{r}
pos_na <- function(x, y) {
  
  if (length(x) != length(y)) {
    return("The vectors are not the same length.")
  }
  
  positions <- which(is.na(x) & is.na(y))
  
  return(positions)
}

```

```{r}
# Test 1
pos_na(c(1, NA, 2), c(NA, NA))

# Test 2
pos_na(c(NA, NA, 2), c(NA, NA, 2))

# Test 3
pos_na(c(NA, 5, NA), c(NA, NA, NA))

# Test 4
pos_na(c(NA, NA, NA, 2, NA, 4, NA),
       c(NA, NA, 2, 4, 4, NA, NA))

# Test 5
pos_na(c(1, NA, NA, 2, NA, 4, NA),
       c(NA, -5, 2, 4, 4, NA, 11))

```

------------------------------------------------------------------------

### (1i) Using an `if` statement

Write a version of `pos_na()` that checks whether the two input vectors have the same length using an `if` statement.

-   If they do, return the positions where both vectors contain `NA`.

-   If they do not, return the message:

> `"The vectors are not the same length."`

### 

```{r}
pos_na_if <- function(x, y) {
  
  if (length(x) == length(y)) {
    
    positions <- which(is.na(x) & is.na(y))
    return(positions)
    
  } else {
    
    return("The vectors are not the same length.")
    
  }
}

```

```{r}
pos_na_if <- function(x, y) {
  
  if (length(x) == length(y)) {
    
    positions <- which(is.na(x) & is.na(y))
    return(positions)
    
  } else {
    
    return("The vectors are not the same length.")
    
  }
}


```

```{r}
pos_na_if(c(1, NA, 2), c(NA, NA))
pos_na_if(c(NA, NA, 2), c(NA, NA, 2))
pos_na_if(c(NA, 5, NA), c(NA, NA, NA))
pos_na_if(c(NA, NA, NA, 2, NA, 4, NA),
          c(NA, NA, 2, 4, 4, NA, NA))
pos_na_if(c(1, NA, NA, 2, NA, 4, NA),
          c(NA, -5, 2, 4, 4, NA, 11))

```

### (1ii) Without using an `if` statement

Write a second version of `pos_na()` that performs the same task **without** using an `if` statement.

-   You may use any other valid R mechanism (e.g., `stop()`, `stopifnot()`, or logical short‑circuiting) to handle the case where the vectors differ in length.
-   

```{r}
pos_na_no_if <- function(x, y) {
  
  stopifnot(length(x) == length(y))
  
  which(is.na(x) & is.na(y))
}
```

```{r}
pos_na_no_if(c(1, NA, 2), c(NA, NA))
pos_na_no_if(c(NA, NA, 2), c(NA, NA, 2))
pos_na_no_if(c(NA, 5, NA), c(NA, NA, NA))
pos_na_no_if(c(NA, NA, NA, 2, NA, 4, NA),
             c(NA, NA, 2, 4, 4, NA, NA))
pos_na_no_if(c(1, NA, NA, 2, NA, 4, NA),
             c(NA, -5, 2, 4, 4, NA, 11))
```

```         
```

```{r}
pos_na_no_if <- function(x, y) {
  length(x) == length(y) || stop("Vectors must have the same length")
  which(is.na(x) | is.na(y))
}

```

# Question 2

Load the `wmata_ridership` data frame into R from <https://dcgerard.github.io/stat_412_612/data/wmata_ridership.csv>. For each month, calculate the proportion of rides made on a given day of the month. Then make box plots of the proport

# Question 3:

Write R code that extracts the elements "Bears", "Dolphins", and "Bengals" from the vector `V` shown below, and display the result.

```{r}
V <- c("Bears", "Lions", "Dolphins", "Eagles", "Bengals")
```

```{r}
V <- c("Bears", "Lions", "Dolphins", "Eagles", "Bengals")

V[c(1, 3, 5)]

```

```{r}
V[c(1, 3, 5)]

```

## (3i) Subsetting by index

```{r}
V <- c("Bears", "Lions", "Dolphins", "Eagles", "Bengals")

V[c(1, 3, 5)]

```

## (3ii) Subsetting using a `for` loop

```{r}
V <- c("Bears", "Lions", "Dolphins", "Eagles", "Bengals")

result <- c()   # empty vector to store matches

for(i in 1:length(V)) {
  if(V[i] %in% c("Bears", "Dolphins", "Bengals")) {
    result <- c(result, V[i])
  }
}

result

```

## (3iii)Returning all values in a single vector (one line of code)

```{r}
V <- c("Bears", "Lions", "Dolphins", "Eagles", "Bengals")

```

### (a) Using positive indices

```{r}
V[c(1, 2, 3, 4, 5)]

```

### (b) Using negative indices

```{r}
V[-0]

```

### (c) Using logical indexing

```{r}
V[rep(TRUE, length(V))]

```

### (d) Attempting to subset by names

```{r}
V["Bears"]

```

# Question 4:

You are given a character vector containing messy employee records. Each entry includes:

-   an employee name (string),
-   a hire date in inconsistent formats,
-   and a department code that should be treated as a factor.

```{r}
records <- c(
  "Steve McQueen | 2020-01-15 | HR",
  "B. Smith | 15/02/2021 | FIN",
  "Carlos M | March 3, 2019 | IT",
  "D. Lee | 2018/07/30 | HR",
  "Alain Delon | 04-12-2020 | MKT"
)
records
```

1.  **Parse each record** into three separate variables:

    -   `name`\
    -   `hire_date`\
    -   `dept`

    ```{r}
    split_records <- strsplit(records, " \\| ")

    ```

    ```{r}
    name <- sapply(split_records, `[`, 1)
    hire_date <- sapply(split_records, `[`, 2)
    dept <- sapply(split_records, `[`, 3)

    ```

```{r}
name

```

```{r}
hire_date

```

```{r}
dept

```

1.  **Convert `hire_date` into a proper `Date` object**, correctly handling all of the different date formats.

    ```{r}
    hire_date <- as.Date(hire_date, tryFormats = c(
      "%Y-%m-%d",
      "%d/%m/%Y",
      "%B %d, %Y",
      "%Y/%m/%d",
      "%m-%d-%Y"
    ))


    ```

    ```{r}
    hire_date

    ```

2.  **Convert `dept` into an ordered factor** with the levels:\
    `HR`, `FIN`, `IT`, `MKT`.

```{r}
dept <- factor(dept,
               levels = c("HR", "FIN", "IT", "MKT"),
               ordered = TRUE)

```

```{r}
dept

```

```{r}
class(dept)

```

1.  **3.Construct a clean data frame** containing the parsed and converted variables.

```{r}
employees <- data.frame(
  name = name,
  hire_date = hire_date,
  dept = dept
)

employees

```

```{r}
str(employees)

```

1.  **Add a new variable** called `years_worked` that reports the number of full years each employee has worked as of today.

```{r}
today <- Sys.Date()

```

```{r}
years_worked <- as.integer(
  floor(as.numeric(difftime(today, hire_date, units = "days")) / 365.25)
)

```

```{r}
employees$years_worked <- years_worked

employees

```

```{r}
str(employees)

```

1.  **Return the final cleaned data frame.**

```{r}
employees

```

```{r}
employees

```

```{r}
employees <- data.frame(
  name = name,
  hire_date = hire_date,
  dept = dept
)

today <- Sys.Date()

employees$years_worked <- as.integer(
  floor(as.numeric(difftime(today, employees$hire_date, units = "days")) / 365.25)
)

employees

```

```{}
```
